{"version":3,"sources":["webpack:///webpack/bootstrap 6c65d48d43af6cc1352e","webpack:///./lib/theremax.js","webpack:///./lib/grid.js","webpack:///./lib/control.js","webpack:///./lib/note.js"],"names":["Theremax","ctx","el","grid","bindMouseDownHandler","bindMouseUpHandler","bindMouseMoveHandler","bindTouchDownHandler","bindTouchMoveHandler","bindTouchEndHandler","bindMouseHandlers","bindTouchHandlers","window","setInterval","step","draw","addEventListener","e","handleMouseDown","handleMouseUp","handleTouchDown","handleTouchEnd","handleTouchMove","handleMouseMove","document","event","console","log","canvas","getElementById","width","innerWidth","height","innerHeight","context","getContext","tm","start","NUM_CONTROLS","DIM_X","DIM_Y","Grid","controls","touches","focusObject","mouseDown","addControls","scroll","click","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","preventDefault","stopPropagation","stop","pos","objects","allControls","i","length","isClicked","posArray","j","targetTouches","et","push","getCursorPosition","target","touchMap","opts","getClicked","unmatchedPos","matchedEls","move","unmatchedEls","filter","u","indexOf","shift","newTouches","reduce","a","b","concat","p","radius","norm","acc","Math","sin","PI","saveStyle","strokeStyle","saveWidth","lineWidth","saveAlpha","globalAlpha","clearRect","lineJoin","beginPath","moveTo","lineTo","stroke","forEach","object","drawGrid","max","min","Control","options","color","note","fillStyle","arc","fill","wrap","dxp","dyp","AudioContext","webkitAudioContext","createOscillator","freq","osc","type","frequency","value","detune","currentTime","createGainNode","gainNode","createGain","gain","connect","destination","Note","pFreq","pAmp","pow","volume","oscillatorNode","pVol"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6c65d48d43af6cc1352e","import Grid from './grid.js';\n\nclass Theremax {\n  constructor(ctx, el) {\n    this.grid = new Grid();\n    this.el = el;\n    this.ctx = ctx;\n  }\n\n  bindMouseHandlers() {\n    this.bindMouseDownHandler();\n    this.bindMouseUpHandler();\n    this.bindMouseMoveHandler();\n  }\n\n  bindTouchHandlers() {\n    this.bindTouchDownHandler();\n    this.bindTouchMoveHandler();\n    this.bindTouchEndHandler();\n  }\n\n  start() {\n    this.bindMouseHandlers();\n    this.bindTouchHandlers();\n    window.setInterval(\n      () => {\n        this.grid.step();\n        this.grid.draw(this.ctx);\n      },\n      40\n    );\n    // TODO: Listener for resize\n  }\n\n  bindMouseDownHandler() {\n    this.el.addEventListener(\"mousedown\",\n      (e) => {\n        this.grid.handleMouseDown(e);\n      }\n    );\n  }\n\n  bindMouseUpHandler() {\n    this.el.addEventListener(\"mouseup\",\n      (e) => {\n        this.grid.handleMouseUp(e);\n      }\n    );\n  }\n\n  bindTouchDownHandler() {\n    this.el.addEventListener(\"touchstart\",\n      (e) => {\n        this.grid.handleTouchDown(e);\n      }\n    );\n  }\n\n  bindTouchEndHandler() {\n    this.el.addEventListener(\"touchend\",\n      (e) => {\n        this.grid.handleTouchEnd(e);\n      }\n    );\n    this.el.addEventListener(\"touchcancel\",\n      (e) => {\n        this.grid.handleTouchEnd(e);\n      }\n    );\n  }\n\n  bindTouchMoveHandler() {\n    this.el.addEventListener(\"touchmove\",\n      (e) =>  {\n        this.grid.handleTouchMove(e);\n      }\n    );\n  }\n\n  bindMouseMoveHandler() {\n    this.el.addEventListener(\"mousemove\",\n      (e) => {\n        this.grid.handleMouseMove(e);\n      }\n    );\n  }\n}\n\ndocument.addEventListener(\"DOMContentLoaded\",\n  function(event) {\n    console.log(\"FOOOOOO\");\n    let canvas = document.getElementById(\"game-canvas\");\n    canvas.width = window.innerWidth-30;\n    canvas.height = window.innerHeight-30;\n    let context = canvas.getContext(\"2d\");\n    window.el = canvas;\n    let tm = new Theremax(context, canvas);\n    tm.start();\n  }\n);\n\n\n\n// WEBPACK FOOTER //\n// ./lib/theremax.js","import Control from './control.js';\nconst NUM_CONTROLS = 1;\n\nvar DIM_X = 800;\nvar DIM_Y = 600;\n\nclass Grid {\n  constructor() {\n    DIM_X = window.innerWidth;\n    DIM_Y = window.innerHeight;\n    this.width = DIM_X;\n    this.height = DIM_Y;\n    this.controls = [];\n    this.touches = [];\n    this.focusObject = null;\n    this.mouseDown = false;\n    this.addControls();\n    this.scroll = 0;\n    this.click = null;\n  }\n\n  getCursorPosition(canvas, event) {\n      var rect = canvas.getBoundingClientRect();\n      var x = event.clientX - rect.left;\n      var y = event.clientY - rect.top;\n      return [x,y];\n  }\n\n  handleMouseUp(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.click && this.click.stop();\n    this.click = null;\n    this.mouseDown = false;\n    this.focusObject = null;\n  }\n\n  getClicked(pos) {\n    let objects = this.allControls();\n    for (var i = 0; i < objects.length; i++) {\n      if (objects[i].isClicked(pos)) {\n        return objects[i];\n      }\n    }\n    return null;\n  }\n\n  touchMap(e) {\n    let posArray = [];\n    for (var j = 0; j < e.targetTouches.length; j++) {\n      let et = e.targetTouches[j];\n      posArray.push(this.getCursorPosition(e.target, et));\n      // posArray.push([et.clientX, et.clientY]);\n    }\n    return posArray;\n  }\n\n  handleTouchDown(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let posArray = this.touchMap(e);\n\n    var el, opts;\n    for (var i = 0; i < posArray.length; i++) {\n      if ((el = this.getClicked(posArray[i]))) {\n        // Pass\n      } else {\n        opts = {\n          pos: posArray[i],\n          grid: this\n        };\n        this.touches.push(new Control(opts));\n      }\n    }\n  }\n\n  handleTouchMove(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let posArray = this.touchMap(e);\n    let unmatchedPos = [];\n    let matchedEls = [];\n    let el;\n    for (var i = 0; i < posArray.length; i++) {\n      if ((el = this.getClicked(posArray[i]))) {\n        matchedEls.push(el);\n        el.move(posArray[i]);\n      } else {\n        unmatchedPos.push(posArray[i]);\n      }\n    }\n    // Clean up dropped notes.\n\n    let unmatchedEls = this.allControls().filter((u) => matchedEls.indexOf(u) < 0);\n    while (unmatchedEls.length > unmatchedPos.length) {\n      el = unmatchedEls.shift();\n      (this.controls.indexOf(el) < 0) && el.stop();\n    }\n    while (unmatchedPos.length > unmatchedEls.length) {\n      this.touches.push(new Control({grid: this, pos: unmatchedPos.shift()}));\n    }\n    for (i = 0; i < unmatchedEls.length; i++) {\n      console.log(\"Unmatched: \", unmatchedPos, unmatchedEls);\n      unmatchedEls[i].move(unmatchedPos[i]);\n    }\n  }\n\n  handleTouchEnd(e) {\n    let posArray = this.touchMap(e);\n    let newTouches = [];\n    for (var i = 0; i < this.touches.length; i++) {\n      let el = this.touches[i];\n      if (posArray.reduce((a, pos) => a || el.isClicked(pos), 0)) {\n        newTouches.push(el);\n      } else {\n        el.stop();\n      }\n    }\n    if (this.focusObject && posArray.reduce(\n      (a,b)=> a || this.focusObject.isClicked(b),\n      0\n    )) {\n      // pass\n    } else {\n      this.focusObject = null;\n    }\n    this.touches = newTouches;\n  }\n\n  handleMouseMove(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let pos = this.getCursorPosition(e.target, e);\n\n    if (this.focusObject) {\n      this.focusObject.move(pos);\n    }\n  }\n\n  handleMouseDown(e) {\n    let pos = this.getCursorPosition(e.target, e);\n    if (this.mouseDown) {\n      return;\n    }\n\n    this.mouseDown = true;\n\n    let objects = this.controls;\n    for (var i = 0; i < objects.length; i++) {\n      if (objects[i].isClicked(pos)) {\n        this.focusObject = objects[i];\n        return;\n      }\n    }\n    this.focusObject = new Control({pos, grid: this});\n    this.click = this.focusObject;\n  }\n\n  allControls() {\n    return this.controls.concat(this.touches).concat(this.click).concat(this.focusObject).filter((p=>p));\n  }\n\n  addControls() {\n    for (var i = 1; i < NUM_CONTROLS+1; i++) {\n      let opts = {\n        // pos: [ 30, i * (1/(NUM_CONTROLS+1)) * (DIM_Y-30) + 15 ],\n        pos: [ 30, i * (1/(NUM_CONTROLS+1)) * (DIM_Y-30) + 15 ],\n        grid: this,\n        radius: 30\n      };\n      console.log(opts);\n      this.controls.push(new Control(opts));\n    }\n  }\n\n  sin(x) {\n    let norm = this.allControls().length;\n    return DIM_Y/2 + this.allControls().reduce(\n      (acc, el) => acc + el.pos[1]*0.5/norm*Math.sin(this.scroll + x*4*Math.PI * (1 + el.pos[0] * 15 / DIM_X) / DIM_X),\n      0\n    );\n  }\n\n  draw(ctx) {\n    // TODO: THIS MUST BE BROKEN UP.\n    let saveStyle = ctx.strokeStyle;\n    let saveWidth = ctx.lineWidth;\n    let saveAlpha = ctx.globalAlpha;\n    ctx.clearRect(0, 0, DIM_X, DIM_Y);\n    ctx.lineWidth = 3;\n    ctx.lineJoin = \"round\";\n    ctx.beginPath();\n    ctx.moveTo(0, this.sin(0));\n\n    for (var i = 0; i <= DIM_X; i += 5) {\n      // console.log(i, this.sin(i));\n      ctx.lineTo(i, this.sin(i));\n    }\n\n    ctx.globalAlpha = 0.5;\n    ctx.strokeStyle = \"#11AA11\";\n    ctx.lineWidth = 5;\n    ctx.stroke();\n    ctx.lineWidth = 10;\n    ctx.stroke();\n    ctx.lineWidth = 3;\n    ctx.strokeStyle = \"#CCFFDD\"; //#33FF33\";\n    ctx.globalAlpha = 1;\n    ctx.stroke();\n\n    ctx.globalAlpha = saveAlpha;\n    ctx.strokeStyle = saveStyle;\n    ctx.lineWidth = saveWidth;\n    this.allControls().forEach(\n      (object) => {\n        object && object.draw(ctx);\n      }\n    );\n    this.drawGrid(ctx);\n\n  }\n\n  drawGrid(ctx) {\n    let saveStyle = ctx.strokeStyle;\n    ctx.strokeStyle = \"#AAAAAA\";\n    for (var i = 0; i <= DIM_X; i += 80) {\n      ctx.beginPath();\n      ctx.moveTo(i, 0);\n      ctx.lineTo(i, DIM_Y);\n      ctx.stroke();\n    }\n    let saveWidth = ctx.lineWidth;\n    ctx.lineWidth = 5;\n    for (i = 0; i <= DIM_Y/2; i += 80) {\n      ctx.beginPath();\n      ctx.moveTo(0,DIM_Y/2-i);\n      ctx.lineTo(DIM_X, DIM_Y/2-i);\n      ctx.stroke();\n      ctx.beginPath();\n      ctx.moveTo(0,DIM_Y/2+i);\n      ctx.lineTo(DIM_X, DIM_Y/2+i);\n      ctx.stroke();\n      ctx.lineWidth = saveWidth;\n    }\n  }\n\n  step() {\n    this.scroll = (this.scroll + 2/(Math.PI));\n  }\n\n  wrap(pos) {\n    return [ Math.max(0, Math.min(DIM_X, pos[0])),\n    Math.max(0, Math.min(DIM_Y, pos[1])) ];\n  }\n}\n\nexport default Grid;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/grid.js","import Note from './note';\n\nclass Control {\n  constructor(options) {\n    this.pos = options.pos || [0,0];\n    this.radius = options.radius || 30;\n    this.color = options.color || \"#FF0000\";\n    this.grid = options.grid;\n\n\n    this.note = new Note(\n      this.pos[0]/this.grid.width,\n      this.pos[1]/this.grid.height\n    );\n\n  }\n\n  stop() {\n    this.note.stop();\n  }\n\n  draw(ctx) {\n    let { strokeStyle, fillStyle, lineWidth, globalAlpha } = ctx;\n    ctx.beginPath();\n    ctx.fillStyle = this.color;\n    ctx.arc(...this.pos, this.radius, 0, 2 * Math.PI, false);\n    ctx.fill();\n    ctx.fillStyle = fillStyle;\n  }\n\n  move(pos) {\n    this.pos = this.grid.wrap(pos);\n    this.note.shift(\n      this.pos[0]/this.grid.width,\n      this.pos[1]/this.grid.height\n    );\n    return this.pos;\n  }\n\n  isClicked(pos) {\n    let dxp = this.pos[0] - pos[0];\n    let dyp = this.pos[1] - pos[1];\n    return dxp*dxp + dyp*dyp <= this.radius * this.radius;\n  }\n}\n\n\nexport default Control;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/control.js","const ctx = new (window.AudioContext || window.webkitAudioContext)();\n\nconst createOscillator = (freq) => {\n  const osc = ctx.createOscillator();\n  osc.type = \"sine\";\n  osc.frequency.value = freq;\n  osc.detune.value = 0;\n  osc.start(ctx.currentTime);\n  return osc;\n};\n\nconst createGainNode = () => {\n  const gainNode = ctx.createGain();\n  gainNode.gain.value = 0;\n  gainNode.connect(ctx.destination);\n  return gainNode;\n};\n\nclass Note {\n  constructor(pFreq, pAmp) {\n    let freq = 100*Math.pow(16, pFreq);\n    this.volume = pAmp * .2;\n    this.oscillatorNode = createOscillator(freq);\n    this.gainNode = createGainNode();\n    this.oscillatorNode.connect(this.gainNode);\n\n    this.start();\n  }\n\n  shift(pFreq, pVol) {\n    this.gainNode.gain.value = pVol * .2;\n    this.oscillatorNode.frequency.value = 100*Math.pow(16, pFreq);\n  }\n\n  start() {\n    this.gainNode.gain.value = this.volume;\n  }\n\n  stop() {\n    this.gainNode.gain.value = 0;\n  }\n}\n\nexport default Note;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/note.js"],"sourceRoot":""}